# 13. 타입스크립트와 객체 지향

## 13.1 타입스크립트의 객체 지향

타입스크립트와 리액트에서 어떤 식으로 객체 지향을 쓰고 있는지, 어떻게 효과적으로 활용할 수 있을지 알아보자.

자바스크립트는 프로토타입 기반의 객체 지향 언어이다. 일부 기능을 지원하지 않지만, 타입스크립트가 private과 같은 접근 제어자나 추상 클래스, 추상 메서드 같은 기능을 지원해서 부족한 부분들을 해결해준다.

타입스크립트는 점진적 타이핑, 구조적 타이핑, 덕 타이핑이 결합한 언어이다.

- 점진적 타이핑은 프로그램 전체가 아닌 개발자가 명시한 일부분만 정적 타입 검사를 거치게 하고 나머지 부분은 그대로 동적 타입 검사가 이루어지게 하여 점진적 개선을 할 수 있도록 해준다.
- 덕 타이핑은 객체의 변수와 메서드 집합이 객체의 타입을 결정하게 해준다.
- 구조적 타이핑을 구조적 타입 시스템이라고 부른다. 명시적인 선언이나 이름에 의존하여 명확한 상속 관계를 지향하는 노미널 타이핑(Nominal Typing)과 달리, 구조적 타이핑은 객체의 속성에 해당하는 특정 타입의 속성을 갖는지를 검사하여 타입 호환성을 결정한다.

컴포넌트는 스스로 책임을 져야하는 역할을 수행하면서 다른 컴포넌트 객체와 협력하는 독립적인 객체다. 컴포넌트를 조합하는 것도 객체 지향을 활용하는 것이라고 볼 수 있다.

**객체 지향 관점에서 타입스크립트가 프론트엔드에 어떤 이점을 주는가**

1. 타입스크립트는 prop을 인터페이스로 정의할 수 있다. 객체 지향 패러다임에서는 객체 간의 협력 관계에 초점을 둔다. 컴포넌트 간의 협력 관계를 표현하는 것이 prop이다. 또한 객체자체가 아니라 프레임워크에 의해 객체의 의존성이 주입되는 DI(Dependency Injection 의존성 주입) 패턴을 따르는데, 이러한 패턴을 더욱 명확하게 표현할 수 있게 해주는 것이 타입스크립트다.

DI는 리액트나 뷰 같은 도구를 통해 활용 중이다. DI는 객체 간의 의존 관계를 설정하는데 사용된다.

2. 타입스크립트 자체가 객체 지향적으로 다양한 측면을 표현하는 데 큰 장점을 가지고 있다. 앞서 언급한 대로 타입스크립트는 점진적 타이핑, 구조적 타이핑, 덕 타이핑을 결합한 언어로 객체 지향의 폭을 넓혀준다.

웹 개발을 하면서 제대로 된 객체 지향을 구현하기 어려운 이유가 있다. 선언적인 언어 또는 문법을 사용할 때가 있기 때문이다. JSX와 같은 선언적인 문법을 사용하여 마크업을 처리한다. 하지만 HTML 마크업을 선언적으로 작성할 때는 컴포넌트 간의 관계를 먼저 떠올리기 어렵다.

변경이 용이하고 유지보수성이 높은 설계를 하기 위해 객체 지향을 구현하는 것인데 사전에 레이아웃의 변화를 예측할 수 없다.
이런 변동을 대응하기 위해 MVP, MVC, MVVM 등의 다양한 패턴이 등장했지만 이것들이 만병통치약은 아니다. 선언적인 문법을 사용하면서 객체 지향을 완벽하게 구현한다는 것은 너무 이상적인 이야기다.

프론트엔드에서 객체 지향을 어떻게 효과적으로 활용할 수 있을까? 회사의 전략과 프로젝트의 방향성에 따라 다양한 접근 방식이 있을 것이다. 특히 **레이아웃은 예상치 못한 변동 사항이 생길 가능성이 높기 때문에 미확정 영역으로 두고 공통으로 사용되는 컴포넌트와 비즈니스 영역에서 객체 지향 원칙을 적용하여 설계하면 좋은 구조를 개발할 수 있을 것이다.**

## 13.2 우아한형제들의 활용 방식

우형의 설계 방식

- 온전히 레이아웃만 담당하는 컴포넌트 영역
- 컴포넌트 영역 위에서 레이아웃과 비즈니스 로직을 연결해주는 커스텀 훅 영역
- 훅 영역 위에서 객체로서 상호 협력하는 모델 영역
- 모델 영역 위에서 API를 해석하며 모델로 전달하는 API 레이어 영역

### 1. 컴포넌트 영역

`components/CartCloseoutDialog.tsx`

레이아웃 영역만 담당. 비즈니스 로직은 전역 상태를 관리하는 useCartStore에 있음

### 2. 커스텀 훅 영역

`store/cart.ts`, `serializers/cart/addToCartRequest.ts`

> 커스텀 훅이란? 컴포넌트에서 비즈니스 로직을 분리하여 재사용성을 높이는 방법.

장바구니에 상품을 담는 비즈니스 로직을 레이아웃과 연결해주기 위한 커스텀 훅 영역. 내부에는 addToCart라는 API 호출 함수가 있음.

addToCartRequest는 API 요청을 위한 데이터를 가공하는 함수. 이 함수는 커스텀 훅에서 사용된다.

### 3. 모델 영역

`models/Cart.ts`

RecommendProduct는 클래스로 표현된 객체로 추천 상품을 나타내며, 이 객체는 다른 컴포넌트 및 모델 객체와 함께 협력하게 된다.

### 4. API 레이어 영역

`apis/Cart.ts`

API 레이어는 API를 호출하고 응답을 해석하여 모델 객체로 변환하는 역할을 한다.

#### 맺음 말

앞선 예시들을 통해 어떤 식으로 각 객체에 적절한 역할과 책임을 할당하여 올바른 협력을 구성하고 설계해야 하는지를 이해할 수 있을 것이다.

## 13.3 캡슐화와 추상화

올바른 협력을 설계하기 위해서는 적절한 캡슐화가 이루어져야 한다. 프로젝트 설계의 궁극적인 목표는 객체들이 유기적으로 협력하게끔 만들어서 적절하게 도메인 분리를 하는 것이다.

추상화도 별것이 아니다. 객체들을 모델링하는 과정 자체가 추상화다. 이 객체들을 좀 더 사람이 인지할 수 있도록 적합한(Cart, Product, Sellect 등) 설계를 하는 것이 곧 추상화다.

**캡슐화란** 다른 객체 내부의 데이터를 꺼내와서 직접 다루지 않고, 해당 객체에게 처리할 행위를 따로 요청함으로써 협력하는 것이다. 프론트엔드 관점에서 쉽게 생각해보자. 컴포넌트는 객체다. 컴포넌트의 내부 데이터인 상태가 바로 캡슐화의 대상이 될 수 있다. 결국 **컴포넌트 내의 상태와 prop을 잘 다루는 것도 캡슐화의 개념에 부합하는 것이다.**

Prop drilling이 심할수록 컴포넌트 간의 결함도는 높아지며 내부 처리 로직이 외부로 드러나기 마련이다. 즉, Prop drilling은 좋지 못한 관계를 형성하게 하고 캡슐화를 저해한다. 이런 문제를 해결하기 위해 옵저버 패턴이 등장했으며 나아가 컨텍스트 API 및 Redux, MobX, Recoil과 같은 다양한 상태 관리 라이브러리가 생겼다. 도구를 적절히 활용해보자.

최종 지향점은 객체들이 유기적으로 협력하게끔 해서 올바르게 도메인을 분리하는 것이다. 어떻게 하면 더 유기적인 협력 관계를 만들어낼 수 있을지, 명확하게 도메인을 분리할 수 있을지에 집중해보자.

## 13.4 정리

객체 지향은 현실 세계와 닮은 패러다임이기에 객체 지향을 의식하지 않고 개발하더라도 나중에 보면 객체 지향이 이미 적용되어 있을 때가 많다. 함수, 클래스, 모듈을 분리하는 것도 객체 지향 프로그램의 일부다.

객체 그 자체보다는 객체의 책임을 먼저 생각하라.

우선 객체나 책임을 신경 쓰지 않고 개발 속도에 집중하여 화면 전체를 만든 후에 각 부분의 역할과 책임을 나누면서 리팩터링하는 방법도 객체 지향을 구현하기 위한 트레이닝이 될 수 있다.

객체 지향은 유지보수를 위한 개념인데, 유지보수가 필요하지 않다면 객체 지향을 꼭 따른 필요가 없을지도 모른다. 현실 세계를 잘 반영하고 좋은 추상화를 어떻게 만들지 고민하며 개발한다면 변경에 유연하고 유지보수하기 쉬운 설계를 구축할 수 있을 것이다.
